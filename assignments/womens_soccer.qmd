---
title: "Women's Soccer Data"
output: html_notebook
---

We'll use this notebook to explore some NCAA women's soccer data and [our questions](https://docs.google.com/spreadsheets/d/1kTSrnl1URmcexIWLDMWqDnp3q-c2OS45uifnhjp10n4/edit#gid=0). First, let's load the tidyverse library:

```{r}
library(tidyverse)
```

We'll want to start with 2023 match data, which is located in [this GitHub repository](https://github.com/dwillis/NCAAWomensSoccerData). We can load the match data directly from GitHub using `read_csv`:

```{r}
matches_2023 <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2023.csv")
matches_2024 <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2024.csv")
```

Let's take a look at this data to see what it contains, using `head` and `glimpse`:

```{r}

head(matches_2023)
glimpse(matches_2023)
view(matches_2023)

```

Now, onto the questions using aggregates, which means `group_by` and `summarize`:

1. How many shots in total has Maryland attempted and how many have been on goal? Calculate a percentage of shots on goal.

The Maryland Terrapins have attempted 180 total shots and 77 of those were on goal. A calculation of their percentage of shots on goal shows 42.77778%. 

```{r}

matches_2024 |>
  group_by(team) |>
  summarize(
    total_sh = sum(sh_att),
    shots_ong = sum(so_g),
    pct_sog = (shots_ong / total_sh) * 100) |>
  filter(team == "Maryland Terrapins, Terps") |>
  arrange(desc(total_sh))

```

2. What about the same shot stats from last season's first four games? You'll need to load the matches from 2022 - just change the season in the URL - and filter by date to find the first four games.

In the first four games of the 2022 season, the Maryland Terrapins had 48 shots, with 23 of those on goal. That calculates to 47.91667% of shots on goal over that stretch of games.

```{r}
matches_2022 <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2022.csv")
view(matches_2022)
```

```{r}

matches_2022 |>
  filter(
    team == ("Maryland Terrapins, Terps"),  
    date %in% c("2022-08-18", "2022-08-25", "2022-08-28", "2022-09-01")) |>
  group_by(team) |>
  summarize(
    total_sh = sum(sh_att), 
    shots_ong = sum(so_g),
    pct_sog = (shots_ong / total_sh) * 100
  ) |>
  arrange(desc(total_sh))  

```


3. What about draws - Maryland started 2022 with 4 ties. Have any other teams had as many this season?

No other teams have started the 2024 season with four or more draws. However, six schools have three draws. 

```{r}

matches_2024 <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2024.csv")
view(matches_2024)

```

```{r}

draws_24 <- matches_2024 |>
  filter(outcome == "Draw")
  
```

```{r}

draws_24 |>
  group_by(team) |>
  summarise(
    tot_draws = n()) |>
  #filter(tot_draws >= 4) |>
  arrange(desc(tot_draws))

```

4. How many total corner kicks has Maryland had so far and how many have its opponents have? Calculate the difference between the two totals for every team.

The Maryland Terrapins have earned 18 corner kicks so far in the 2024 season, its opponents have earned 23 corner kicks, indicating a difference of -5 corners in favor of the Terps' opponents. Among all schools in the 2024 matches data frame, the Virginia Tech Hokies have the highest positive difference in corners with 42. The McNeese Cowgirls have the largest negative difference, earning 41 less corners than opponents. For the Hokies, the disparity could play a factor in their undefeated start to the season (4-0-1).

```{r}

matches_2024 |>
 filter(
    team == ("Maryland Terrapins, Terps")) |>
      summarise(
        terp_corners = sum(corners),
        opp_corners = sum(defensive_corners),
        diff_corners = sum(corners) - sum(defensive_corners)
      )

```


```{r}

matches_2024 |>
  group_by(team) |>
  summarise(
    tot_corners = sum(corners),
    opp_corners = sum(defensive_corners),
    diff_corners = sum(corners) - sum(defensive_corners)
  ) |>
  arrange(desc(diff_corners))

```

```{r}

#corners_24 <- matches_2024 |> 
 # mutate(corner_ratio = corners/defensive_corners)


corners_24 |>
  filter(corner_ratio >= 4.0)|>
  group_by(outcome)|>
  summarise(count = n())
  

```


```{r}

matches_2024 |>
  group_by(team) |>
  summarize(
    total_sh = sum(sh_att),
    shots_ong = sum(so_g),
    pct_sog = (shots_ong / total_sh) * 100) |>
  arrange(desc(pct_sog))


```


Create a significance test on total scoring (goals + defensive_goals) for all NCAA teams using the 2023 and 2024 data. Load the 2023 and 2024 matches data above. For both, we'll need to add a column called `total_goals` and populate it using `mutate()`.

Our Null Hypothesis is that there is no significant difference in the average number of goals scored in 2023 and 2024. Our Alternative Hypothesis is there is a significant difference in the average number of goals scored in 2023 and 2024.

Based on the output (read from the bottom), is scoring up this year, and is that result significant? Explain your answers in the notebook

What about scoring in Maryland games? Do the same t-test and answer the same questions.

```{r}
 
goals_23 <- matches_2023 |>
  mutate(total_goals = goals + defensive_goals)

goals_24 <- matches_2024 |>
  mutate(total_goals = goals + defensive_goals)

```


Our Null Hypothesis is that there is no significant difference in the average number of goals scored in 2023 and 2024. Our Alternative Hypothesis is there is a significant difference in the average number of goals scored in 2023 and 2024.


```{r}

g_result <- t.test(goals_23$total_goals, goals_24$total_goals, alternative="two.sided", var.equal = TRUE)
print(g_result)

```
Based on the output (read from the bottom), is scoring up this year, and is that result significant?

Based on the output, the samples are incredibly similar but there is a marginal increase in scoring this year. However, the incredibly small p-value suggests that there is a stastical significance in the scoring increase between the seasons. Therefore, we'd reject the null hypothesis in this case.

What about scoring in Maryland games? Do the same t-test and answer the same questions.

```{r}

umd_goals23 <- goals_23 |> filter(team == 'Maryland Terrapins, Terps') 
umd_goals24 <- goals_24 |> filter(team == 'Maryland Terrapins, Terps')

umd_g_result <- t.test(umd_goals23$total_goals, umd_goals24$total_goals, alternative ="two.sided", var.equal = TRUE)

print(umd_g_result)

```

Because the p-value is larger than our 0.05 significance level, we can conclude that there is no statistically significant difference between the average number of goals scored by UMD between the 2023 season and the beginning of the 2024 season. In essence, it's probably too early to tell.


```{r}

umd_goals23 <- goals_23 |> filter(team == 'Maryland Terrapins, Terps') |> filter(date < '2023-09-12')
umd_goals24 <- goals_24 |> filter(team == 'Maryland Terrapins, Terps') 

umd_g_result <- t.test(umd_goals23$total_goals, umd_goals24$total_goals, alternative ="two.sided", var.equal = TRUE)

print(umd_g_result)

```

After adjusting the UMD test to filter and target early season games, we see a larger disparity in scoring between the seasons. However, our t-test is still larger than 0.05, so the data does not provide strong enough evidence to conclude that there is a significant difference in scoring.










